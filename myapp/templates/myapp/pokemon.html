{% load static %}
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> Pokedex {% block title %} {% endblock %}</title>
   

    <!-- Bootstrap core CSS -->
    <link href="{% static 'css/bootstrap.min.css'%}" rel="stylesheet">
    <link href="{% static 'css/main.css'%}" rel="stylesheet">
    <link href="{% static 'css/pokemon.css'%}" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css">

    <style>
      .tick line {
          display: none;
      }
      .skill-background {
          fill: #e9ecef;
      }

      .skill-progressbar {
          animation: progress 3s ease-out forwards;
      }
      @keyframes progress {
          0% { 
              width: 0; 
          }
      }
      .skill-progressbar:hover {
          opacity: 0.7;
      }
      
      .skill-text {
          fill: white;
          text-anchor: end;
          font-family: sans-serif;
          font-size: 8pt;
          animation: hideshow 10s ease forwards;
      }
      @keyframes hideshow {
          0% { 
              opacity: 0; 
          }
          100% {
              opacity: 1;
          }
      }
    </style>

  </head>
  <body>
    
<header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Pokedex</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav me-auto mb-2 mb-md-0">
          <li class="nav-item">
            <a class="nav-link active" href="#">A PROPOS</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="#">STATS</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="#">EVOLUTION(S)</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="#">ATTAQUE(S)</a>
          </li>
        </ul>

        <form class="d-flex">
          <input class="form-control me-2" type="search" placeholder="Cherche ton Pokémon" aria-label="Search">
          <button class="btn btn-outline-success" type="submit">Trouver</button>
        </form>
      </div>
    </div>
  </nav>
</header>

<main>

  <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="{% static 'images/pokemon3.png'%}" class="d-block w-100" alt="...">
        <div class="carousel-caption d-none d-md-block">
          <h1>Pokedex</h1>
          <h3>Trouvez toutes les informations de votre Pokémon préféré !</h3>
        </div>
      </div>
    </div>
  </div>



  <div class="container marketing">

    <hr class="featurette-divider">

    <div class="row featurette">
      <div class="col-md-8">
        <h2>A PROPOS</h2>
        <p>NOM : {{ namefr }}</p>
        <p>ID : {{ id }}</p>
        <p>ABILITES : {{ abilites_francais.0 }} : {{ desc_abilites_1.0 }}, {{ abilites_francais.1 }} : {{ desc_abilites_2.0 }}</p>
        <p>DESCRIPTION : {{ desc }}</p>
        <p>TAILLE : {{ height }} m</p>
        <p>POIDS : {{ weight }} kg</p>
        <p>TYPE : {{ typeFr.0 }}, {{ typeFr.1 }}</p>
        <p>FAIBLE CONTRE : {{ weak.0 }} {{ weak.1 }} {{ weak.2 }}</p>
        <p>FORT CONTRE : {{ strong.0 }} {{ strong.1 }} {{ strong.2 }}</p>
        <p>SEXE : {{ female }} {{ male }} {{ no_genre }} EGG : {{ egg }}</p>
        <p>TAUX DE CAPTURE : {{ tauxDeCapture }}%</p>
        <p>LIEUX : {{ habitatFr }}</p>
        <p>COULEURS : {{ color.0 }} {{ color.1 }}</p>
      <div class="col-md-4">
        <img src="{{ image }}" style="width:350px;height:350px">
      </div>
    </div>

    <hr class="featurette-divider">
    
    <div class="row featurette">
      <h2>STATS</h2>
      <div class="container my-5">
        <div id="skill-chart"></div>
      </div>
    </div>

    <hr class="featurette-divider">

    <div class="row">
      <h2>EVOLUTION(S)</h2>
      <div class="col-lg-4">
        <img src="{{ evolImage.0 }}" width="140" height="140">
        <p>ID : {{ evolId.0 }} NOM : {{ evolution.0 }}</p>
      </div>
      <div class="col-lg-4">
        <img src="{{ evolImage.1 }}" width="140" height="140">
        <p>ID : {{ evolId.1 }} NOM : {{ evolution.1 }}</p>
      </div>
      <div class="col-lg-4">
        <img src="{{ evolImage.2 }}" width="140" height="140">
        <p>ID : {{ evolId.2 }} NOM : {{ evolution.2 }}</p>
      </div>
    </div>

    <hr class="featurette-divider">

    <div class="row">

      <h2>ATTAQUE(S)</h2>
      <table class="table table-hover table-dark">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Nom</th>
            <th scope="col">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th scope="row">1</th>
            <td>{{ attaque_fr.0 }}</td>
            <td>{{ attaque_desc.0 }}</td>
          </tr>
          <tr>
            <th scope="row">2</th>
            <td>{{ attaque_fr.1 }}</td>
            <td>{{ attaque_desc.1 }}</td>
          </tr>
          <tr>
            <th scope="row">3</th>
            <td>{{ attaque_fr.2 }}</td>
            <td>{{ attaque_desc.2 }}</td>
          </tr>
          <tr>
            <th scope="row">4</th>
            <td>{{ attaque_fr.3 }}</td>
            <td>{{ attaque_desc.3 }}</td>
          </tr>
          <tr>
            <th scope="row">5</th>
            <td>{{ attaque_fr.4 }}</td>
            <td>{{ attaque_desc.4 }}</td>
          </tr>
          <tr>
            <th scope="row">6</th>
            <td>{{ attaque_fr.5 }}</td>
            <td>{{ attaque_desc.5 }}</td>
          </tr>
          <tr>
            <th scope="row">7</th>
            <td>{{ attaque_fr.6 }}</td>
            <td>{{ attaque_desc.6 }}</td>
          </tr>
          <tr>
            <th scope="row">8</th>
            <td>{{ attaque_fr.7 }}</td>
            <td>{{ attaque_desc.7 }}</td>
          </tr>
          <tr>
            <th scope="row">9</th>
            <td>{{ attaque_fr.8 }}</td>
            <td>{{ attaque_desc.8 }}</td>
          </tr>
          <tr>
            <th scope="row">10</th>
            <td>{{ attaque_fr.9 }}</td>
            <td>{{ attaque_desc.9 }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <hr class="featurette-divider">

  </div>

  <!-- SCRIPT -->
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js"></script>
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <script>
      const skillData = [
          {name: "HP", value: "{{ data.0 }}", color: "#6610f2"},
          {name: "ATTAQUE", value: "{{ data.1 }}", color: "#28a745"},
          {name: "DEFENSE", value: "{{ data.2 }}", color: "#0d6efd"},
          {name: "ATTAQUE SPE", value: "{{ data.3 }}", color: "#fd7e14"},
          {name: "DEFENSE SPE", value: "{{ data.4 }}", color: "#FF5B5C"},
          {name: "VITESSE", value: "{{ data.5 }}", color: "#dc3545"},
      ];

      skillChart('#skill-chart', skillData, {
          size: 600,
          barSize: 25,
          margin: {
              top: 0, 
              right: 0, 
              bottom: 0, 
              left: 80
          }
      })

      function skillChart(el, data, options = {}) {
          const width = options.size;
          const height = Math.ceil((data.length + 0.1) * options.barSize) + options.margin.top + options.margin.bottom;

          const svg = d3.create("svg").attr("viewBox", [0, 0, width, height]);

          const x = d3.scaleLinear().domain([0, 150]).range([options.margin.left, width - options.margin.right]);

          const y = d3.scaleBand().domain(d3.range(data.length)).rangeRound([options.margin.top, height - options.margin.bottom]).padding(0.25);
          
          svg.append("g")
              .selectAll("rect")
              .data(data)
              .join("rect")
              .attr("class", "skill-background")
              .attr("fill", d => d.color)
              .attr("x", x(0))
              .attr("y", (d, i) => y(i))
              .attr("rx", "8")
              .attr("width", width - (options.margin.left + options.margin.right))
              .attr("height", y.bandwidth());

              svg.append("g")
              .selectAll("rect")
              .data(data)
              .join("rect")
              .attr("class", "skill-progressbar")
              .attr("fill", d => d.color)
              .attr("filter", d => "drop-shadow(0px 2px 3px "+d.color+")")
              .attr("data-toggle", "tooltip")
              .attr("data-placement", "top")
              .attr("data-html", "true")
              .attr("title", d => "<strong>"+d.name+"</strong><br/>"+d.value)
              .attr("x", x(0))
              .attr("y", (d, i) => y(i))
              .attr("rx", "8")
              .attr("width", d => x(d.value) - x(0))
              .attr("height", y.bandwidth());

          svg.append("g")
              .attr("class", "skill-text")
              .selectAll("text")
              .data(data)
              .join("text")
              .attr("x", d => x(d.value))
              .attr("y", (d, i) => y(i) + y.bandwidth() / 2)
              .attr("dy", "0.35em")
              .attr("dx", -4)
              .text(d => d.value)
              .call(text => text.filter(d => x(d.value) - x(0) < 20).attr("dx", +4).attr("fill", "black").attr("text-anchor", "start"));

          const axis = g => g.attr("transform", "translate("+options.margin.left+",0)")
              .call(d3.axisLeft(y).tickFormat(i => data[i].name).tickSizeOuter(0))
              .call(g => g.select(".domain").remove());

          svg.append("g").call(axis);

          document.querySelector(el).appendChild(svg.node());
      }

      let tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-toggle="tooltip"]'))
      let tooltipList = tooltipTriggerList.map(tooltipTriggerEl => {
          return new bootstrap.Tooltip(tooltipTriggerEl)
      })
  </script>

  <footer class="container">
    <p class="float-end"><a href="#">Back to top</a></p>
    <p>&copy; 2021 Pokedex</p>
  </footer>
</main>
      
  </body>
</html>